# Folder Security Tool
function Show-Menu {
    Clear-Host
    Write-Host "==============================="
    Write-Host "     Folder Security Tool"
    Write-Host "==============================="
    Write-Host "1. Create Project Folder"
    Write-Host "2. Create Proposal Folder"
    Write-Host "3. Grant Access to Project Folder"
    Write-Host "4. Grant Access to Proposal Folder"
    Write-Host "5. Exit"
}

function Create-Folder {
    param (
        [string]$FolderPath
    )
    if (-Not (Test-Path $FolderPath)) {
        New-Item -ItemType Directory -Path $FolderPath | Out-Null
        Write-Host "Folder created at $FolderPath"
    } else {
        Write-Host "Folder already exists at $FolderPath"
    }
}

function Grant-Access {
    param (
        [string]$FolderPath,
        [string]$UserOrGroup
    )
    $acl = Get-Acl $FolderPath
    $accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($UserOrGroup, "Modify", "ContainerInherit,ObjectInherit", "None", "Allow")
    $acl.SetAccessRule($accessRule)
    Set-Acl -Path $FolderPath -AclObject $acl
    Write-Host "Access granted to $UserOrGroup for $FolderPath"
}

# Main loop
do {
    Show-Menu
    $choice = Read-Host "Select an option (1-5)"

    switch ($choice) {
        "1" {
            $path = Read-Host "Enter full path for Project folder"
            Create-Folder -FolderPath $path
        }
        "2" {
            $path = Read-Host "Enter full path for Proposal folder"
            Create-Folder -FolderPath $path
        }
        "3" {
            $path = Read-Host "Enter full path of Project folder"
            $user = Read-Host "Enter user or group to grant access"
            Grant-Access -FolderPath $path -UserOrGroup $user
        }
        "4" {
            $path = Read-Host "Enter full path of Proposal folder"
            $user = Read-Host "Enter user or group to grant access"
            Grant-Access -FolderPath $path -UserOrGroup $user
        }
        "5" {
            Write-Host "Exiting Folder Security Tool..."
        }
        default {
            Write-Host "Invalid selection. Please choose between 1 and 5."
        }
    }

    if ($choice -ne "5") {
        Pause
    }

} while ($choice -ne "5")
